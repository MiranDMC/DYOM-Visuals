
jump @DYOM_VISUALS_EFFECTS_END

// load params from config or apply defaults
// arg 0 - objective idx, -1 to reset defaults 
:EFFECTS_CONFIG_UPDATE_PARAMS
    //10@ is there just because cleo_call needs to store result in some variable otherwise it will crash
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 1.0 'speed' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 70.0 'fov' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'forceCinematic' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'forceBumper' result 1@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'forceWalking' reuslt 2@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'forceAiming' result 3@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'drunkenness' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'darkness' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'fadeout' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'fadein' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'shake' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 0.0 'siteorkcet' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 1.0 'radar' result 10@
    cleo_call @EFFECTS_CONFIG_READ_PARAM args 3 0@ 1.0 'hud' result 10@
    
    0@ = 0
    005A: 0@ += 1@
    005A: 0@ += 2@
    005A: 0@ += 3@
cleo_return 1 0@

// arg 0 - objective idx, -1 to reset defaults 
// arg 1 - (float) default parameter value
// arg 2 - parameter name
:EFFECTS_CONFIG_READ_PARAM
    cleo_call @CONFIG_READ_PARAM args 3 0@ 1@ 2@ result 1@
    
    string_format 3@v = string_format "%s" 2@ // copy param name into local variables
    
    0@ = 0
    
    if
        3@v == "speed"
    then
        015D: set_gamespeed 1@
    end
    
    if
        3@v == "fov"
    then
        0922: set_camera_zoom_from 1@ to 1@ timelimit 1000 smooth_transition 0
        0931: lock_camera_zoom 1
    end
    
    if
        3@v == "forceCinematic"
    then
        0092: 1@ = float 1@ to_integer
        093D: lock_camera_on_cinematic_view 1@
    end
    
    if
        3@v == "forceBumper"
    then
        0092: 1@ = float 1@ to_integer
        if
            0039: 1@ == 1
        then
            0@ = 1
        end
    end
    
    if
        3@v == "forceWalking"
    then 
        0092: 1@ = float 1@ to_integer
                if
            0039: 1@ == 1
        then
            0@ = 2
        end
        06AF: set_player $PLAYER_CHAR sprint_mode 1@ // 1 to disable 0 to enable sprint
        1@ = 1 - 1@ // if 8@ = 1 then 0, if 8@ = 0, then 1
        0901: enable_player $PLAYER_CHAR jump_key 1@
        082A: set_player $PLAYER_CHAR able_to_use_crouch_button 1@

    end
    
    if
        3@v == "forceAiming"
    then
        0092: 1@ = float 1@ to_integer
                if
            0039: 1@ == 1
        then
            0@ = 4
        end  
        1@ = 1 - 1@ // if 8@ = 1 then 0, if 8@ = 0, then 1
        0992: set_player $PLAYER_CHAR weapons_scrollable 1@
  
    end
    
    if
        3@v == "drunkenness"
    then
        0092: 1@ = float 1@ to_integer
        052C: set_player $PLAYER_CHAR drunk_visuals 1@
    end
    
    if
        3@v == "darkness"
    then
        0092: 1@ = float 1@ to_integer
        0924: enable_screen_darkness 1@ with_value -1
    end
    
    if
        3@v == "fadeout"
    then
        0092: 1@ = float 1@ to_integer
        016A: fade 0 time 1@
    end
    
    if
        3@v == "fadein"
    then
        0092: 1@ = float 1@ to_integer
        016A: fade 1 time 1@
    end
    
    if
        3@v == "shake"
    then
        0092: 1@ = float 1@ to_integer
        0003: shake_camera 1@
    end
    
    if
        3@v == "siterocket"
    then
        0092: 1@ = float 1@ to_integer
        09A3: show_siterocket_on_bumper_camera 1@
    end
    
    if
        3@v == "radar"
    then
        0092: 1@ = float 1@ to_integer
        0581: enable_radar 1@
    end
    
    if
        3@v == "hud"
    then
        0092: 1@ = float 1@ to_integer
        0826: enable_hud 1@
        09B9: show_entered_car_name 1@
        09BA: show_entered_zone_name 1@
    end
           
cleo_return 1 0@



/*
:FORCE_AIMING
    if
        forceAiming == 1
    then
    0ACE: show_formatted_text_box "This is %.4X opcode" 0x0ACE
    
        cleo_call @FORCE_KEYPRESS 1 args 12     
    end
    return
    
    :FORCE_WALKING
    if
        forceWalking == 1
    then
        cleo_call @FORCE_KEYPRESS 1 args 42
    end
return


:FORCE_BUMPER
    if
        forceBumper == 1
    then
        09AD: set_vehicle_camera_mode 0
    end
return

:FORCE_KEYPRESS
    0@ += 0xB734D0 // High Priority Controls
    0A8C: write_memory 0@ size 1 value 255 virtual_protect 0
cleo_return 0
*/

:DYOM_VISUALS_EFFECTS_END

